<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>编译GLib应用程序</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
<link rel="home" href="index.html" title="GLib 参考手册">
<link rel="up" href="glib.html" title="GLib概述">
<link rel="prev" href="glib-cross-compiling.html" title="交叉编译GLib软件包">
<link rel="next" href="glib-running.html" title="运行GLib应用程序">
<meta name="generator" content="GTK-Doc V1.17 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="2"><tr valign="middle">
<td><a accesskey="p" href="glib-cross-compiling.html"><img src="left.png" width="24" height="24" border="0" alt="Prev"></a></td>
<td><a accesskey="u" href="glib.html"><img src="up.png" width="24" height="24" border="0" alt="Up"></a></td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="24" height="24" border="0" alt="Home"></a></td>
<th width="100%" align="center">GLib 参考手册</th>
<td><a accesskey="n" href="glib-running.html"><img src="right.png" width="24" height="24" border="0" alt="Next"></a></td>
</tr></table>
<div class="refentry">
<a name="glib-compiling"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2><span class="refentrytitle">编译GLib应用程序</span></h2>
<p>编译GLib应用程序 — 如何编译GLib应用程序</p>
</td>
<td valign="top" align="right"></td>
</tr></table></div>
<div class="refsect1">
<a name="id2939272"></a><h2>在UNIX上编译GLib应用程序</h2>
<p>为了编译GLib应用程序，你需要告诉编译器在哪里找到GLib的头文件及库. <span class="application">pkg-config</span> 工具会帮你.</p>
<p>下面的shell会话展示了 <span class="application">pkg-config</span> 如何工作 (输出可能因不同的系统有所不同): </p>
<pre class="programlisting">
$ pkg-config --cflags glib-2.0
 -I/usr/include/glib-2.0 -I/usr/lib/glib-2.0/include 
$ pkg-config --libs glib-2.0
 -L/usr/lib -lm -lglib-2.0  
</pre>
<p>如果你的应用程序使用线程(threads)或者 <span class="structname">GObject</span> 特性, 则必须用以下的 <span class="application">pkg-config</span> 输出来编译及链接: </p>
<pre class="programlisting">
$ pkg-config --cflags --libs gthread-2.0
$ pkg-config --cflags --libs gobject-2.0
</pre>
<p>如果你的应用程序使用模块(modules), 则必须用以下的 <span class="application">pkg-config</span> 输出来编译及链接: </p>
<pre class="programlisting">
$ pkg-config --cflags --libs gmodule-no-export-2.0 
$ pkg-config --cflags --libs gmodule-2.0 
</pre>
<p> 两者的不同之处在于gmodule-2.0 为连接添加了<code class="option">--export-dynamic</code> 标志, 但它并不经常用到.</p>
<p>最简单的编译方式是使用shell的"反引号"特性. 如果你将命令放入反引号里 (<span class="emphasis"><em>不是单引号</em></span>), 那么它的输出会在命令行执行前 取代命令.所以编译一个GLib的Hello,World,你输入以下命令: </p>
<pre class="programlisting">
$ cc `pkg-config --cflags --libs glib-2.0` hello.c -o hello
</pre>
<p>如果你确定你的程序不使用任何过时的函数,你可以为预处理器定义 G_DISABLE_DEPRECATED 符号,使用命令选项 <code class="literal">-DG_DISABLE_DEPRECATED=1</code>.</p>
<p>使用GLib的推荐方式是只包含最顶层的头文件 <code class="filename">glib.h</code>, <code class="filename">glib-object.h</code>, <code class="filename">gio.h</code>. 从2.17开始,当直接包含单独的头文件时GLib会强制生成一个错误. 为了帮助大家过渡,执行器在默认的Glib头文件中未打开(但GObject和GIO是打开的) 为了打开它,使用命令行<code class="literal"> -DG_DISABLE_DEPRECATED</code> 来定义预处理器符号 G_DISABLE_SINGLE_INCLUDES 即可. <code class="filename">glib/gprintf.h</code> and <code class="filename">glib/gstdio.h</code> (we don't want to pull in all of stdio).</p>
<p>
Starting with 2.17, GLib enforces this by generating an error
when individual headers are directly included. To help with the 
transition, the enforcement is not turned on by default for GLib 
headers (it <span class="emphasis"><em>is</em></span> turned on for GObject and GIO).
To turn it on, define the preprocessor symbol G_DISABLE_SINGLE_INCLUDES
by using the command line option <code class="literal">-DG_DISABLE_SINGLE_INCLUDES</code>.
</p>
</div>
</div>
<div class="footer">
<hr>
          Generated by GTK-Doc V1.17</div>
</body>
</html>